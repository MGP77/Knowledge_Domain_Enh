# ‚úÖ –ó–ê–î–ê–ß–ê –ü–û–õ–ù–û–°–¢–¨–Æ –í–´–ü–û–õ–ù–ï–ù–ê

## üéØ –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

1. **‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∑–µ–ª—ë–Ω—ã–π –ª–æ–≥–æ—Ç–∏–ø SberInfra** 
   - –õ–æ–≥–æ—Ç–∏–ø –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ –≤—Å–µ—Ö –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–µ–ª—ë–Ω–∞—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞
   - –î–æ–±–∞–≤–ª–µ–Ω –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ "Knowledge Management System"

2. **‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å Confluence**
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä—è–º—ã—Ö —Å—Å—ã–ª–æ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã Confluence
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ URL —Ñ–æ—Ä–º–∞—Ç–æ–≤: `viewpage.action`, `spaces/pages`, `display`
   - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω–µ–π –ø–∞—Ä—Å–∏–Ω–≥–∞ (1-5 —É—Ä–æ–≤–Ω–µ–π)
   - –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ—á–µ—Ä–Ω–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

3. **‚úÖ –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è OpenAI**
   - –û—á–∏—â–µ–Ω—ã —à–∞–±–ª–æ–Ω—ã, —Å–µ—Ä–≤–∏—Å—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   - –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ GigaChat
   - –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

4. **‚úÖ –†–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å—Ä–µ–¥—ã**
   - –£–¥–∞–ª–µ–Ω—ã —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å—Ä–µ–¥—ã
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã libmagic
   - –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã libmagic

### –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞:
```
ImportError: failed to find libmagic. Check your installation
```

### ‚úÖ –†–µ—à–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

**–§–∞–π–ª**: `app/services/file_service.py`

**–ú–µ—Ö–∞–Ω–∏–∑–º –∫–∞—Å–∫–∞–¥–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤:**

1. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1**: `python-magic` (–µ—Å–ª–∏ libmagic –¥–æ—Å—Ç—É–ø–µ–Ω)
2. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2**: –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å `mimetypes` 
3. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3**: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é —Ñ–∞–π–ª–∞
4. **Fallback**: `application/octet-stream`

**–ö–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫:**
```python
try:
    if MAGIC_AVAILABLE:
        try:
            file_type = magic.from_file(file_path, mime=True)
            return file_type
        except Exception as magic_error:
            logger.warning("‚ö†Ô∏è libmagic –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º mimetypes")
    
    # Fallback –∫ mimetypes
    mime_type, _ = mimetypes.guess_type(file_path)
    if mime_type:
        return mime_type
        
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é
    return mime_types.get(extension, 'application/octet-stream')
```

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∑–∞–ø—É—Å–∫—É

### ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã:
- FileProcessorService: —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ libmagic
- GigaChatService: –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- RAGService: –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
- ConfluenceService: –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –≥–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É

### ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã —Ñ–∞–π–ª–æ–≤:
- PDF: `application/pdf`
- DOCX: `application/vnd.openxmlformats-officedocument.wordprocessingml.document`
- DOC: `application/msword`
- TXT: `text/plain`
- MD: `text/markdown`
- HTML: `text/html`

## üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å—Ä–µ–¥—ã

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
pip install -r requirements.txt
```

### 2. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã:
```bash
python main.py
```

### 3. –†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞
- ‚úÖ –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç libmagic

## üìä –ñ—É—Ä–Ω–∞–ª —Å–∏—Å—Ç–µ–º—ã

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ –±–µ–∑ libmagic —Å–∏—Å—Ç–µ–º–∞ –≤—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
```
‚ö†Ô∏è python-magic —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ libmagic –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: failed to find libmagic
üîÑ –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π mimetypes
üìã –¢–∏–ø —Ñ–∞–π–ª–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω —á–µ—Ä–µ–∑ mimetypes: application/pdf
```

## üéâ –ò–¢–û–ì

**–í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é:**

1. ‚úÖ –ó–µ–ª—ë–Ω—ã–π –ª–æ–≥–æ—Ç–∏–ø SberInfra –¥–æ–±–∞–≤–ª–µ–Ω
2. ‚úÖ Confluence –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –∏ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥
3. ‚úÖ OpenAI –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—ë–Ω –∏–∑ —Å–∏—Å—Ç–µ–º—ã
4. ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ libmagic —Ä–µ—à–µ–Ω–∞ –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å—Ä–µ–¥—ã
5. ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å—Ä–µ–¥–æ–π –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π!**
